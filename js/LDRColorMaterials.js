'use strict';

var LDR = {};
LDR.Colors = {};

LDR.Colors = [];
LDR.Colors[0] = {value:0x000000};
LDR.Colors[1] = {value:0x0055bf};
LDR.Colors[2] = {value:0x237841};
LDR.Colors[3] = {value:0x008f9b};
LDR.Colors[4] = {value:0xc91a09};
LDR.Colors[5] = {value:0xc870a0};
LDR.Colors[6] = {value:0x583927};
LDR.Colors[7] = {value:0x9ba19d};
LDR.Colors[8] = {value:0x6d6e5c};
LDR.Colors[9] = {value:0xb4d2e3};
LDR.Colors[10] = {value:0x4b9f4a};
LDR.Colors[11] = {value:0x55a5af};
LDR.Colors[12] = {value:0xf2705e};
LDR.Colors[13] = {value:0xfc97ac};
LDR.Colors[14] = {value:0xf2cd37};
LDR.Colors[15] = {value:0xf6f6f6};
LDR.Colors[16] = {value:0xFFFF80};
LDR.Colors[17] = {value:0xc2dab8};
LDR.Colors[18] = {value:0xfbe696};
LDR.Colors[19] = {value:0xe4cd9e};
LDR.Colors[20] = {value:0xc9cae2};
LDR.Colors[21] = {value:0xd4d5c9};
LDR.Colors[22] = {value:0x81007b};
LDR.Colors[23] = {value:0x2032b0};
LDR.Colors[24] = {value:0x7F7F7F};
LDR.Colors[25] = {value:0xfe8a18};
LDR.Colors[26] = {value:0x923978};
LDR.Colors[27] = {value:0xbbe90b};
LDR.Colors[28] = {value:0x958a73};
LDR.Colors[29] = {value:0xe4adc8};
LDR.Colors[30] = {value:0xac78ba};
LDR.Colors[31] = {value:0xe1d5ed};
LDR.Colors[32] = {value:0x635f52};
LDR.Colors[33] = {value:0x0020a0};
LDR.Colors[34] = {value:0x84b68d};
LDR.Colors[35] = {value:0xd9e4a7};
LDR.Colors[36] = {value:0xc91a09};
LDR.Colors[37] = {value:0xdf6695};
LDR.Colors[38] = {value:0xff800d};
LDR.Colors[39] = {value:0xc1dff0};
LDR.Colors[40] = {value:0x635f52};
LDR.Colors[41] = {value:0xcfe2f7};
LDR.Colors[42] = {value:0xf8f184};
LDR.Colors[43] = {value:0xaeefec};
LDR.Colors[44] = {value:0x96709f};
LDR.Colors[45] = {value:0xe4adc8};
LDR.Colors[46] = {value:0xf5cd2f};
LDR.Colors[47] = {value:0xfcfcfc};
LDR.Colors[52] = {value:0xa5a5cb};
LDR.Colors[54] = {value:0xdab000};
LDR.Colors[57] = {value:0xf08f1c};
LDR.Colors[60] = {value:0x645a4c};
LDR.Colors[61] = {value:0x6c96bf};
LDR.Colors[62] = {value:0x3cb371};
LDR.Colors[63] = {value:0xaa4d8e};
LDR.Colors[64] = {value:0x1b2a34};
LDR.Colors[68] = {value:0xf3cf9b};
LDR.Colors[69] = {value:0xcd6298};
LDR.Colors[70] = {value:0x582a12};
LDR.Colors[71] = {value:0xa0a5a9};
LDR.Colors[72] = {value:0x6c6e68};
LDR.Colors[73] = {value:0x5a93db};
LDR.Colors[74] = {value:0x73dca1};
LDR.Colors[75] = {value:0x000000};
LDR.Colors[76] = {value:0x635f61};
LDR.Colors[77] = {value:0xfecccf};
LDR.Colors[78] = {value:0xf6d7b3};
LDR.Colors[79] = {value:0xffffff};
LDR.Colors[80] = {value:0xa5a9b4};
LDR.Colors[81] = {value:0x899b5f};
LDR.Colors[82] = {value:0xdbac34};
LDR.Colors[83] = {value:0x575857};
LDR.Colors[84] = {value:0xcc702a};
LDR.Colors[85] = {value:0x3f3691};
LDR.Colors[86] = {value:0x7c503a};
LDR.Colors[89] = {value:0x4c61db};
LDR.Colors[92] = {value:0xd09168};
LDR.Colors[100] = {value:0xfebabd};
LDR.Colors[110] = {value:0x4354a3};
LDR.Colors[112] = {value:0x6874ca};
LDR.Colors[114] = {value:0xdf6695};
LDR.Colors[115] = {value:0xc7d23c};
LDR.Colors[117] = {value:0xffffff};
LDR.Colors[118] = {value:0xb3d7d1};
LDR.Colors[120] = {value:0xd9e4a7};
LDR.Colors[125] = {value:0xf9ba61};
LDR.Colors[129] = {value:0xa5a5cb};
LDR.Colors[132] = {value:0x000000};
LDR.Colors[133] = {value:0x000000};
LDR.Colors[134] = {value:0xae7a59};
LDR.Colors[135] = {value:0x9ca3a8};
LDR.Colors[137] = {value:0x7988a1};
LDR.Colors[142] = {value:0xdcbc81};
LDR.Colors[148] = {value:0x575857};
LDR.Colors[150] = {value:0xabadac};
LDR.Colors[151] = {value:0xe6e3e0};
LDR.Colors[178] = {value:0xb48455};
LDR.Colors[179] = {value:0x898788};
LDR.Colors[183] = {value:0xf2f3f2};
LDR.Colors[191] = {value:0xf8bb3d};
LDR.Colors[212] = {value:0x9fc3e9};
LDR.Colors[216] = {value:0xb31004};
LDR.Colors[226] = {value:0xfff03a};
LDR.Colors[231] = {value:0xFCB76D};
LDR.Colors[232] = {value:0x7dbfdd};
LDR.Colors[272] = {value:0x0a3463};
LDR.Colors[284] = {value:0xC281A5};
LDR.Colors[288] = {value:0x184632};
LDR.Colors[293] = {value:0x6BABE4};
LDR.Colors[294] = {value:0xbdc6ad};
LDR.Colors[297] = {value:0xaa7f2e};
LDR.Colors[302] = {value:0xAEE9EF};
LDR.Colors[308] = {value:0x352100};
LDR.Colors[313] = {value:0x3592c3};
LDR.Colors[320] = {value:0x720e0f};
LDR.Colors[321] = {value:0x078bc9};
LDR.Colors[322] = {value:0x36aebf};
LDR.Colors[323] = {value:0xadc3c0};
LDR.Colors[326] = {value:0x9b9a5a};
LDR.Colors[334] = {value:0xbba53d};
LDR.Colors[335] = {value:0xd67572};
LDR.Colors[339] = {value:0xC0FF00};
LDR.Colors[351] = {value:0xf785b1};
LDR.Colors[366] = {value:0xfa9c1c};
LDR.Colors[373] = {value:0x845e84};
LDR.Colors[378] = {value:0xa0bcac};
LDR.Colors[379] = {value:0x6074a1};
LDR.Colors[383] = {value:0xe0e0e0};
LDR.Colors[450] = {value:0xb67b50};
LDR.Colors[462] = {value:0xffa70b};
LDR.Colors[484] = {value:0xa95500};
LDR.Colors[503] = {value:0xe6e3da};

var ldraw_transparent = [33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,52,54,57,114,117,129,231,284,293,294,302,339];
for(var i = 0; i < ldraw_transparent.length; i++) {
    var colorID = ldraw_transparent[i];
    LDR.Colors[colorID]["alpha"] = 128;
}
LDR.Colors[0]["edge"] = 0x595959;
LDR.Colors[6]["edge"] = 0x1E1E1E;
LDR.Colors[23]["edge"] = 0x1E1E1E;
LDR.Colors[70]["edge"] = 0x595959;
LDR.Colors[85]["edge"] = 0x1E1E1E;
LDR.Colors[272]["edge"] = 0x1E1E1E;
LDR.Colors[288]["edge"] = 0x595959;
LDR.Colors[308]["edge"] = 0x595959;

/*
  Functions for creating Three.js materials:
 */
LDR.Colors.getTriangleMaterial = function(colorID) {
    var colorObject = LDR.Colors[colorID];
    if(!colorObject)
	throw "Unknown color: " + colorID;
    if(!colorObject.triangleMaterial) {
	colorObject.triangleMaterial = new THREE.MeshBasicMaterial( { 
	    color: colorObject.value,
	    transparent: colorObject.alpha ? true : false,
	    opacity: colorObject.alpha ? colorObject.alpha/256.0 : 1,
	} );
    }
    return colorObject.triangleMaterial;
}
LDR.Colors.getDesaturatedTriangleMaterial = function(colorID) {
    var colorObject = LDR.Colors[colorID];
    if(!colorObject)
	throw "Unknown color: " + colorID;
    if(!colorObject.desaturatedTriangleMaterial) {
	colorObject.desaturatedTriangleMaterial = new THREE.MeshBasicMaterial( { 
	    color: LDR.Colors.desaturateColor(colorObject.value),
	    transparent: colorObject.alpha ? true : false,
	    opacity: colorObject.alpha ? colorObject.alpha/256.0 : 1,
	} );
    }
    return colorObject.desaturatedTriangleMaterial;
}
LDR.Colors.getLineMaterial = function(colorID) {
    var colorObject = LDR.Colors[colorID];
    if(!colorObject)
	throw "Unknown color: " + colorID;
    if(!colorObject.lineMaterial) {
	colorObject.lineMaterial = new THREE.LineBasicMaterial( { 
	    color: colorObject.value,
	} );
    }
    return colorObject.lineMaterial;
}
LDR.Colors.getEdgeLineMaterial = function(colorID) {
    var colorObject = LDR.Colors[colorID];
    if(!colorObject)
	throw "Unknown color: " + colorID;
    if(!colorObject.lineMaterial) {
	colorObject.lineMaterial = new THREE.LineBasicMaterial( { 
	    color: colorObject.edge ? colorObject.edge : 0x333333,
	} );
    }
    return colorObject.lineMaterial;
}

LDR.Colors.int2RGB = function(i) {
    var b = (i & 0xff);
    i = i >> 8;
    var g = (i & 0xff);
    i = i >> 8;
    var r = i;
    return [r, g, b];
}

LDR.Colors.int2Hex = function(i) {
    var rgb = LDR.Colors.int2RGB(i);
    var ret = '#';
    for(var j = 0; j < 3; j++) {
	rgb[j] = Number(rgb[j]).toString(16);
	if(rgb[j].length == 1)
	    ret += '0';
	ret += rgb[j];
    }
    return ret;
}

LDR.Colors.desaturateColor = function(hex) {
    var threeColor = new THREE.Color(hex);
    var hsl = {};
    threeColor.getHSL(hsl);

    if(hsl.l == 0)
	hsl.l = 0.3;
    else
	hsl.l *= 0.7;

    threeColor.setHSL(hsl.h, hsl.s, hsl.l);
    return threeColor.getHex();
}
