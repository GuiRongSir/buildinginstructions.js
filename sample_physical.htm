<!DOCTYPE html>
<html>
 <head>
  <title>Sample Rendering with Physical Properties</title>
  <meta name="viewport" content="width=device-width" />
 </head>
 <body>
  <script src="js/three.min.js"></script>
  <script src="js/OrbitControls.js"></script>
  <script src="js/colors.js"></script>
  <script src="js/Scene.js"></script>    
  <script src="js/ClientStorage.js"></script>
  <script src="js/LDROptions.js"></script>
  <script src="js/LDRShaders.js"></script>
  <script src="js/LDRColorMaterials.js"></script>
  <script src="js/LDRGeometries.js"></script>
  <script src="js/LDRLoader.js"></script>
  <script src="js/LDRGenerator.js"></script>
  <script src="js/LDRStuds.js"></script>
  <script>
      let startTime = new Date();

      let modelToBeRendered = 'models/fail1.mpd';
      //let modelToBeRendered = 'models/pyramid5.ldr';

      let scene = new ENV.Scene(window.innerWidth, window.innerHeight);
      document.body.appendChild(scene.renderer.domElement);

      let onWindowResize = () => scene.onChange(window.innerWidth, window.innerHeight);
      window.addEventListener('resize', onWindowResize, false);

      let ldrLoader; // Three.js loader for LDraw models
      let onLoad = function() {
        let inv = new THREE.Matrix3(); inv.set(1,0,0, 0,-1,0, 0,0,-1); // Invert Y, and Z-axis for LDraw
        ldrLoader.getMainModel().generateThreePart(ldrLoader, 36, new THREE.Vector3(), inv, true, false, scene.mc);

        scene.buildStandardScene();
        onWindowResize(); // Render

        console.log("Scene rendered in " + (new Date()-startTime) + "ms.");
      }

      let ldrOptions = new LDR.Options(); ldrOptions.lineContrast = 2; // 2 for no lines.
      let logo = 0; // 0 for quick draw. 4 for special logo.

      ldrLoader = new THREE.LDRLoader(onLoad, false, {physicalRenderingAge:20});
      LDR.Studs.setStuds(ldrLoader, 0, logo, () => ldrLoader.load(modelToBeRendered));

      new THREE.OrbitControls(scene.camera, scene.renderer.domElement).addEventListener('change', () => scene.render());
  </script>
 </body>
</html>
